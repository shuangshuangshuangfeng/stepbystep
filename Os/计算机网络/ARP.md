# ARP 工作原理

**ARP:**  地址解析协议

**作用:**  将 IP 地址转换为 MAC 地址， 工作在网络层， 和 IP 在一层



**ARP工作过程：**

首先，每个主机都会有自己的 ARP 缓存区， 其中建立了一个 ARP 列表，以表示 IP 和 MAC 的对应关系。

当源主机要发送数据时：

①先检查 ARP 列表中是都有对应 IP 地址的目的主机的 MAC 地址， 如果有，直接发送数据，如果没有，则向本网段的所有主机发送 ARP 数据包， 内容如下：

> 我是A IP地址，macA， 谁的IP是B？ MAC是？

② 当本网络的所有主机收到该 ARP 数据包时， 先检查数据包中的 IP 是否时自己的 IP 地址， 如果不是，则忽略该数据包， 如果是，

- 首先，从数据包中取出源 IP 和 源 MAC， 写入自己的ARP列表中， 如果已经存在。
- 然后，将自己的 MAC 地址写入 ARP 响应包中，告诉源主机自己是它想要找的 MAC 地址。

③ 源主机收到 ARP 响应包以后，将目的主机的 IP 和 MAC 写入 arp列表中，并利用此消息发送数据， 。如果源主机一直没有收到 ARP 响应数据包，表示 ARP 查询失败。



需要注意： 广播发 ARP 请求， 单薄发送 ARP 响应

